---
layout: default_ds_blog
title: "Email Scraping With Python"
description: ""
Comment: "Email Scraping With Python"
date: 2019-08-11
---

<div id="wrapper">
	<div id="blog-page" class="blogcontainer">

If you work in an office, chances are you receive and send emails, lots and lots of emails. <br><br>

Like most colleagues in financial services I subscribe to a range of market news and commentary email services. These are written by journalists and market commentators 
and provide daily perspecitives on economics, geopolitics, social and behavioural sciences, etc. and the effect these are having, or being hypothesised to have, on market dynamics.

<br><br>

What I realised was that there was a potentially very interesting and useful time series of data on market topics and sentiment being built in my inbox from these emails.
My corporate email was traditionally not a data set that I was used to querying and my first challenge was to get hold of this data (or at least metadata) in a way that 
allowed me to do some interesting things with it.

<br><br>

I typically set up simple Microsoft Outlook rules that move market emails into separate folders as they arrive in my work inbox. The first thing to do was to somehow navigate 
through the Inbox folder structure and pull something out. Luckily, as is usually the case, a Python module existed that could help, namely pywin32 in this case. The below Python 
code steps through the process for accessing, navigating and extracting some information from my inbox:

	<pre> 
	<code class="python">
	#####################################
	# Python scraper code here
	#####################################

	import numpy as np

	
	</code>
	</pre>

# Organisational efficiency:
Having got the market commentary data out my inbox I was curious to see what a broader review of my sent and received emails could tell me about my working style and collaborators. Having previously defined my Inbox and Sent 
folders, the below quickly pulls out some simple metadata on the emails I receive and send.

#code here

The distribution of when colleagues send me emails is broadly unsurprising: people tend to come into the office for 9:00am with a bang, take an hour to settle in before blasting a range out at 10:00am. Energised after the 
lull at lunch, colleagues begin another round of fire at 2:00pm before a slow tail off to the end of the day. A few dedicated individuals continue late into the evening. 

Sorting by sender illustrated clearly to me who my closest collaborators were (as well as those who spam me the most)

What was more interesting to me was how I was responding to emails. Below is a distribution of my sent emails by sent time:

I generally followed the same pattern as the broader firm, perhaps a less pronounced spike at 10:00am, and and more pronouced one at 8:00pm when I logged on again from home. The real insight for me was just how many emails 
I was sending in the morning, typically my most productive time of the day. Why was I sending so many emails during this time? Doing so was taking up valuable time to write and distrupting my ongoing concentration on 
some difficult piece of data science. Worse still, very few of these needed an immediate response. My take away from this was to block time in my diary in the mornings to do undistracted work 

# Future work
Large corporate organisations struggle with siloed cultures...  

<p>
  When \(a \ne 0\), there are two solutions to \(ax^2 + bx + c = 0\) and they are
  \[x = {-b \pm \sqrt{b^2-4ac} \over 2a}.\]
</p>

<p>
When \(a \ne 0\), there are two solutions to \(ax^2 + bx + c = 0\) and they are
$$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$

$$x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}$$
</p>

	</div>
</div>


