---
layout: default_ds_blog
title: "Email Scraping With Python"
description: ""
Comment: "Email Scraping With Python"
date: 2019-08-11
---

<div id="wrapper">
	<div id="blog-page" class="blogcontainer">

If you work in an office, chances are you receive and send emails; lots and lots of emails. <br><br>

Like most professionals in financial services I subscribe to a range of market news and commentary emails. These are written by journalists, investment professionals and market commentators 
and provide daily perspectives on economics, geopolitics, social and behavioural sciences, etc. and the effect these are having, or being hypothesised to have, on market dynamics.

<br><br>

I recently realised there was a potentially very interesting and useful time series of data on current market topics and sentiment being built in my inbox from these emails.
My corporate email was traditionally not a data set that I was used to querying and my first challenge was to get hold of this data (or at least metadata) in a way that 
allowed me to do some interesting things with it.

<br><br>

I typically set up simple Microsoft Outlook rules that move market emails into separate folders as they arrive in my work inbox. The first thing to do was to somehow navigate 
through the Inbox folder structure and pull something out. Luckily, as is usually the case, a Python module existed that could help, namely pywin32 in this case. The below Python 
code steps through the process for accessing, navigating and extracting some information from my inbox:

	<pre> 
	<code class="python">
	#####################################
	# Python scraper code here
	#####################################

	import numpy as np

	
	</code>
	</pre>

<h3> Organisational Working Patterns </h3> <br>
Having got the market commentary data out my inbox I was curious to see what a broader review of my sent and received emails could tell me about my working style and collaborators. 
Having previously defined my Inbox and Sent 
folders, the below quickly pulls out some simple metadata on the emails I receive and send.

<br><br>
#code here
<br><br>

The below shows the aggregated distribution of the hours of the day when colleagues send me emails

<img style = "width:60%; height: auto" src = '/images/Inbox_Distribution.png'>

This picture is broadly unsurprising: people tend to come into the office for 9:00am with a bang, take an hour to settle in before blasting a range out at 10:00am. Energised 
after lunch at mid day, colleagues begin another round of fire at 2:00pm before a slow tail off to the end of the day. 
<br><br>
A few dedicated individuals continue late into the evening and some from overseas offices continue overnight.

Sorting by sender illustrated clearly to me who my closest collaborators were (as well as those who spam me the most!) Each row in the below is a unique colleague. 
The overlaid blue pareto curve illustrating the well obeserved 80/20 rule in practice.

<img style = "width:60%; height: auto" src = '/images/Inbox_Senders.png'> <br>

<h3> Learnings </h3> <br>
What was more interesting to me was how I was responding to emails. Below is a distribution of my sent emails by sent hour of the day:

<img style = "width:60%; height: auto" src = '/images/Outbox_Distribution.png'><br>

I generally followed the same pattern as the broader firm, perhaps a less pronounced spike at 10:00am, and a more pronouced one at 8:00pm when I logged on again from home. 
The real insight for me was just how many emails I was sending in the morning, typically my most creative and productive time of the day for doing data science. 
<blockquote> Why was I sending so many emails during my most creative time? </blockquote>
Doing so was taking up valuable time to write and distrupting my ongoing concentration on doing or guiding on some difficult piece of data science. 
Worse still, very few of these needed a response in this time. My take away from this was to block non emailing sending time in my diary in the mornings to ensure I was most 
efficient in executing on a difficult piece of work.<br><br>

<h3> Future Work </h3> <br>
Large organisations struggle with many aspects of workforce efficiency, effective communication and siloed teams. I think a review of the corporate email server along these lines
would be very illustrative. When trying to promote knowledge sharing and alignment, you could define a 'collaboration' metric as the ratio of sent emails to received.  

	</div>
</div>


