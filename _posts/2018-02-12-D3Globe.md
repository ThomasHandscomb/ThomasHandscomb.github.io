---
layout: default_ds_blog
title: "Hosting the WebGL Globe on a Local Web-Server With Python"
description: ""
Comment: "Hosting the WebGL Globe on a Local Web-Server With Python"
date: 2018-02-12
---

<div id="wrapper">
	<div id="blog-page" class="blogcontainer">

I recently came across <a href = "https://globe.chromeexperiments.com/">The WebGL Globe </a> released by the <a href = "https://experiments.withgoogle.com/chrome/globe"> Google Data Arts Team </a> 
and thought it would be cool to bring into some projects I was working on.
<br><br>
Heavily leveraging the Javascript <a href = "https://threejs.org/">three.js</a> 3D library, it provides 
a nice, interactive rendering of non-negative measures by geographic location.    

This post steps through how to get this up and running including how to host this visual on a simple http web-server on your local machine using Python.
<br><br>

<h3>Step 1:</h3> Have a look at Google's example showing <a href = "http://globe.chromeexperiments.com/"> global population growth </a> in the 20th century. 
To display your data in this way you will need your input data arranged in a clunky json format as follows: <br><br>
[
<p style="text-indent: 40px">[<i> <b>'seriesA'</b>, [ latitude, longitude, magnitude, latitude, longitude, magnitude, ... ] </i></p>

<p style="text-indent: 40px">]</p>

<p style="text-indent: 40px">[<i> <b>'seriesB'</b>, [ latitude, longitude, magnitude, latitude, longitude, magnitude, ... ] </i></p>

<p style="text-indent: 40px">]</p>

<p style="text-indent: 40px">...</p>

]<br><br>

To transform your data in this way will undoubtedly require some data manipulation as well as a map of latitude/longitude coordinates onto locations (___ provides a handy reference 
table for this). For example your data may more typically look like the below: <br><br>

<table align="center">
<caption><b>Table 1:</b> Sample data</caption>

  <tr>
    <th>Product Name</th>
    <th>Location</th>
    <th>Sales</th>
  </tr>
  <tr>
    <td>Product A</td>
    <td>London</td>
    <td>50</td>
  </tr>
  <tr>
    <td>Product A</td>
    <td>Sydney</td>
    <td>94</td>
  </tr>
  <tr>
    <td>Product A</td>
    <td>Melbourne</td>
    <td>34</td>
  </tr>
  <tr>
    <td>Product B</td>
    <td>Boston</td>
    <td>14</td>
  </tr>
  <tr>
    <td>Product B</td>
    <td>New York</td>
    <td>7</td>
  </tr>
</table>

<br><br>

In this case the <b><i>'seriesA'</i></b>, <b><i>'seriesB'</i></b> labels in the json file would be <b><i>'Product A'</i></b> and <b><i>'Product B'</i></b>. These labels will also need to be reflected in an 
underlying <b>index.html</b> file. This is 
described in some more detail in <b>Step 4</b> below <br><br>

<h3>Step 2:</h3> Download the 'globe' folder from the <a href = "https://github.com/dataarts/webgl-globe"> Data Arts </a> GitHub page. 
<br><br> 
The two files you will need to edit are:

<ul style="list-style-type:disc;">
	<li> 1. <b> index.html </b> which is what you will need to edit to customise the globe </li>
	<li> 2. <b> population909500.json </b> which is the input data file in json format described above </li>
</ul>

Even if you are not super familiar with html you will see places to edit the output (e.g. line 4: Title, line 109: Copyrights. etc.) as well as the 
reference to the json input file (line 168.)<br><br>

<h3>Step 3:</h3> Get this 'out of the box' version running on your machine. If you simply double-click on the <b> index.html </b> file you will get a static web-page with a spinning wheel 
and no globe. To get the globe to resolve you can host a local web server on your machine using python which will display the contents of the <b>index.html</b> file (i.e. the Globe) to you. 
Once you get this baseline version up and running the editing of <b>index.html</b> and the creation of your bespoke json input file are largely 
straight-forward to do.
<br><br> 
The below few lines of python code sets up a local web-server on your machine:

<pre>
	<code class="python">
	#~~~~~~~~~~~~~~~~~~~~~~~~~~~
	# Sets up a local web server
	#~~~~~~~~~~~~~~~~~~~~~~~~~~~
	import http.server
	import socketserver

	PORT = 8000

	Handler = http.server.SimpleHTTPRequestHandler

	httpd = socketserver.TCPServer(("", PORT), Handler)

	print ("Serving at port", PORT)
	httpd.serve_forever()
	
	#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	# Shuts down and closes when finished
	#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	# httpd.shutdown
	# httpd.server_close()
	</code>
</pre>

Ensure you save this .py file <u> in the globe folder </u>, <b>SimpleHTTPRequestHandler</b> is an HTTP request handler that serves files from the 
current directory and any of its subdirectories. 
<br><br>
After running this python code, open Chrome and navigate to <a href = "http://localhost:8000"> http://localhost:8000 </a> You should see the full interactive globe now! 
<br><br>
By default the <b>SimpleHTTPRequestHandler</b> will be looking for a file called <b>index.html</b> in the current directory. As you're developing your version of the Globe you 
can of course rename this file to something more meaningful to you, say to <b>MyFirstGlobe.html</b>, located in the same directory, and then navigate to 
<b>http://localhost:8000/MyFirstGlobe.html</b>
<br><br>

<h3>Step 4:</h3>
Customise your version. To do this you will need to alter the <b>index.html</b> file and align this with your json input data file. For example if your data looked like 
<b>Table 1</b> above then then your json file will look like the following:
<br><br>

[
<p style="text-indent: 40px">[<i> <b>'Product A'</b>, [ lat1, long1, 50, lat2, long2, 94, lat3, long3, 34 ] </i></p>

<p style="text-indent: 40px">]</p>

<p style="text-indent: 40px">[<i> <b>'Product B'</b>, [ lat4, long4, 14, lat5, long5, 7 ] </i></p>

<p style="text-indent: 40px">]</p>

]<br><br>

and the <b>MyFirstGlobe.html</b> file will have the below amendments
<br><br>

<h3>Step 5:</h3>
Roll out more broadly. Once you're happy with your version and want to share within your organisation you have 2 options:

<ul style="list-style-type:disc;">
	<li> 1. Send a couple of interested stakeholders a link to your locally hosted version (i.e. <b>http://localhost:8000/MyFirstGlobe.html</b>) to generate some interest 
	(this will likely result in performance issues if too many people query your machine) </li>
	<li> 2. Ask you IT department is they can host this on an internal web-server for you </li>
</ul>

Enjoy!

	</div>
</div>